---
name: check-reference
description: >
  This skill should be used when the user asks to "check references",
  "verify citations", "参考文献チェック", "引用検証", "ハルシネーションチェック",
  "参照確認", or wants to verify that all references in a document actually
  exist and are accurately described.
---

# Check Reference — 参考文献の正確性検証

文書内の参考文献について、実在性と内容記述の正確性を網羅的に検証するスキル。

**注意**: 論理構成、オーバーステートメント、網羅性などの批評は `peer-review` スキルが担当。

## 検証対象

1. **メタデータの正確性**: 著者名、出版年、掲載誌名、DOI/URL
2. **内容記述の正確性**: 手法、タスク、結果の記述が原典と一致するか

## ワークフロー

### Step 1: 参考文献リストの抽出

対象ファイルを Read で読み、参考文献セクションから全参照をリストアップする。
各参照に番号を振り、総数を確認する。

### Step 2: 検証エージェントの起動

参照数に応じてエージェントを分割し、並列で検証する。

```
Task:
  name: "ref-checker-1"
  subagent_type: general-purpose
  mode: bypassPermissions
  run_in_background: true
```

**分割の目安:**
- 15件以下: 1エージェント
- 16-30件: 2エージェント（前半/後半）
- 31件以上: 3エージェント

**検証エージェントのプロンプトテンプレート:**

```
{file_path} の参考文献 #{start}〜#{end} を検証してください。

## 検証項目

各参考文献について以下を確認:

### A. メタデータ検証
- 著者名が正しいか（DOIリンクまたはWeb Searchで確認）
- 出版年が正しいか
- 掲載誌名が正しいか
- DOI/URLが実在し、該当論文を指しているか

### B. 内容記述検証
- 手法の記述が原典と一致するか
- タスクの種類（二値/多クラス、分類/セグメンテーション等）が正しいか
- 精度値（OA, IoU, F1等）が原典と一致するか
- pixel-level / scene-level / object-level の区別が正しいか

## 検証ツール
- **Web Search**: 著者名+年+キーワードで論文を検索
- **WebFetch**: DOI/URLから直接論文ページにアクセス
- **arXiv MCP** (ToolSearchで"arxiv"を検索): arXiv論文の確認

## 出力形式

検証結果を以下の形式で報告:

### 問題なし
- [#1] Gallwey et al. (2020) — OK

### 問題あり
- [#4] 著者名エラー: "Iannelli et al." → 正しくは "Ibrahim et al."
  根拠: DOIリンク先の論文ページで確認
- [#8] 内容エラー: "二値分類" → 正しくは "多クラスセグメンテーション"
  根拠: arXivの論文アブストラクトで確認
```

### Step 3: 結果の集約

全エージェントの結果を集約し、問題のある参照をリストアップする。

### Step 4: 修正の適用

問題が見つかった場合、Edit ツールでファイルを修正する。
修正箇所は参考文献セクションだけでなく、本文中の該当記述も含む。
replace_all を使い、同一の誤記が複数箇所にある場合はすべて修正する。

### Step 5: 結果報告

ユーザーに以下を報告:
- 検証した参考文献の総数
- 問題が見つかった件数とカテゴリ別内訳
- 適用した修正の一覧

## LLM生成文書の注意点

LLM（大規模言語モデル）が生成した文書では、参考文献のハルシネーション率が30%超に達することがある。

**典型的なハルシネーションパターン:**
- 論文Aの著者名が論文Bに付与される（クロス汚染）
- 実在する著者名だが該当論文の著者ではない
- DOIが別の無関係な論文を指している
- 精度値が四捨五入や記憶違いで微妙に異なる

LLM生成文書の場合は特に入念な検証が必要。
